{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}Test Search - {{ provider.name }}{% endblock %}

{% block content %}
<h1>Test Search - {{ provider.name }}</h1>

<p><a href="{% url 'admin:search_searchprovider_change' provider.pk %}">&larr; Back to {{ provider.name }}</a></p>

<form method="post" action="{% url 'admin:search_searchprovider_test_search' provider.pk %}">
    {% csrf_token %}
    
    <fieldset class="module aligned">
        <h2>Search</h2>
        <div class="form-row">
            <div>
                <label for="query">Search Term:</label>
                <input type="text" name="query" id="query" size="50" placeholder="Enter search term...">
            </div>
        </div>
        
        <div class="form-row">
            <div>
                <label for="media_type">Media Type:</label>
                <select name="media_type" id="media_type">
                    <option value="book">Book</option>
                    <option value="audiobook">Audiobook</option>
                </select>
            </div>
        </div>
        
        <div class="form-row">
            <div>
                <label for="language">Language:</label>
                <select name="language" id="language">
                    <option value="en" selected>English</option>
                </select>
            </div>
        </div>
        
        <div class="form-row">
            <div>
                <button type="submit" name="action" value="search" class="button default">Search</button>
            </div>
        </div>
    </fieldset>
</form>

{% if results %}
    <fieldset class="module">
        <h2>Search Results ({{ results|length }})</h2>
        <div class="results">
            <table id="result_list" class="results">
                <thead>
                    <tr>
                        <th scope="col" class="column-cover">Cover</th>
                        <th scope="col" class="column-title">Title</th>
                        <th scope="col" class="column-authors">Authors</th>
                        <th scope="col" class="column-publisher">Publisher</th>
                        <th scope="col" class="column-publication_date">Publication Date</th>
                        <th scope="col" class="column-isbn">ISBN</th>
                        <th scope="col" class="column-isbn13">ISBN-13</th>
                        <th scope="col" class="column-language">Language</th>
                        <th scope="col" class="column-description">Description</th>
                    </tr>
                </thead>
                <tbody>
                    {% for result in results %}
                    <tr class="{% cycle 'row1' 'row2' %}">
                        <td class="field-cover">
                            {% if result.cover_url %}
                                <img src="{{ result.cover_url }}" alt="Cover" style="max-width: 100px; max-height: 150px;">
                            {% else %}
                                <span class="text-muted">-</span>
                            {% endif %}
                        </td>
                        <td class="field-title"><strong>{{ result.title }}</strong></td>
                        <td class="field-authors">{{ result.authors }}</td>
                        <td class="field-publisher">{{ result.publisher }}</td>
                        <td class="field-publication_date">{{ result.publication_date }}</td>
                        <td class="field-isbn">{{ result.isbn }}</td>
                        <td class="field-isbn13">{{ result.isbn13 }}</td>
                        <td class="field-language">{{ result.language }}</td>
                        <td class="field-description">{{ result.description }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </fieldset>
{% endif %}

{% endblock %}

